<launch>

    <arg name="bag" default="false"/>
    <arg name="map" default="true"/>
    <arg name="system" default="true"/>
    <arg name="sensing" default="true"/>
    <arg name='localization' default='true'/>
    <arg name="perception" default="false"/>
    <arg name="planning" default="false"/>
    <arg name='control' default='false'/>
    
    <arg name='use_pointcloud_map' default='true'/>
    <arg name='use_lanelet2_map' default='true' />
    <arg name='pointcloud_map' default='/root/shared_dir/map/soongsil_0.2.pcd'/>
    <arg name='lanelet2_map' default='/root/shared_dir/map/soongsil_map_test.osm'/>
    <arg name='use_multi_lidar' default='false'/>
    <arg name='yolo_type' default='yolov5m'/>
    <arg name='urdf_file_path' default="$(find-pkg-share ichthus_launch)/urdf/ichthus_NiroEV_multi_lidar.urdf"/>
    <arg name='vehicle_info_param_path' default="$(find-pkg-share ichthus_launch)/param/ichthus_vehicle_info.param.yaml" />

    <arg name='raw_pointcloud_topic' default='/merged_cloud' />
    <arg name='kinematic_state' default='/localization/kinematic_state' />
    <arg name='projector_type' default='MGRS' />

    <arg if="$(eval &quot; '$(var bag)' =='true'&quot;)" name="use_sim_time" default="true"/>
    <arg if="$(eval &quot; '$(var bag)' =='false'&quot;)" name="use_sim_time" default="false"/>

    <include file="$(find-pkg-share ichthus_launch)/launch/taeho/ichthus_map_taeho.launch.py" if='$(var map)'>
      <arg name='use_sim_time' value='$(var use_sim_time)' />
      <arg name='use_pointcloud_map' value='$(var use_pointcloud_map)'/>
      <arg name='use_lanelet2_map' value='$(var use_lanelet2_map)' />
      <arg name='projector_type' value='$(var projector_type) '/>
      <arg name='lanelet2_map' value='$(var lanelet2_map)'/>
      <arg name='pointcloud_map' value='$(var pointcloud_map)'/>
    </include>

    <include file="$(find-pkg-share ichthus_launch)/launch/taeho/ichthus_system_taeho.launch.py" if='$(var system)'>
      <arg name='urdf_file_path' value='$(var urdf_file_path)' />
      <arg name='use_sim_time' value='$(var use_sim_time)' />
    </include>

    <include file="$(find-pkg-share ichthus_launch)/launch/taeho/ichthus_sensing_taeho.launch.py" if='$(var sensing)'>
      <arg name='use_sim_time' value='$(var use_sim_time)' />
      <arg name='use_multi_lidar' value='$(var use_multi_lidar)'/>
      <arg name='vehicle_info_param_path' value='$(var vehicle_info_param_path)' />
      <arg name='raw_pointcloud_topic' value='$(var raw_pointcloud_topic)' />
    </include>

    <include file="$(find-pkg-share ichthus_launch)/launch/taeho/ichthus_localization_taeho.launch.py" if='$(var localization)'>
      <arg name='use_sim_time' value='$(var use_sim_time)' />
    </include>

    <arg name ="lidar_channel" default="16"/>
    <arg if="$(eval &quot; '$(var lidar_channel)' =='16'&quot;)" name="base_name" default="vlp-16"/>
    <arg if="$(eval &quot; '$(var lidar_channel)' =='64'&quot;)" name="base_name" default="hdl-64"/>

    <include file="$(find-pkg-share ichthus_launch)/launch/taeho/ichthus_perception_taeho.launch.py" if='$(var perception)'>
      <arg name='lidar_apollo_instance_segmentation_param_path' value="$(find-pkg-share ichthus_launch)/param/lidar_apollo_instance_segmentation_$(var base_name).param.yaml" />
      <arg name='yolo_type' value='$(var yolo_type)'/>
      <arg name='mode' value='INT8' />
      <arg name='model_name' value='default' />
      <arg name='use_sim_time' value='$(var use_sim_time)' />
      <arg name='vehicle_info_param_path' value='$(var vehicle_info_param_path)' />
    </include>

    <include file="$(find-pkg-share ichthus_launch)/launch/taeho/ichthus_planning_taeho.launch.py" if='$(var planning)'>
      <arg name='use_sim_time' value='$(var use_sim_time)' />
      <arg name='vehicle_info_param_path' value='$(var vehicle_info_param_path)' />
      <arg name='kinematic_state' value='$(var kinematic_state)' />
    </include>

    <include file="$(find-pkg-share ichthus_launch)/launch/taeho/ichthus_control_taeho.launch.py" if='$(var control)'>
      <arg name='use_sim_time' value='$(var use_sim_time)' />
      <arg name='vehicle_info_param_path' value='$(var vehicle_info_param_path)' />
      <arg name='kinematic_state' value='$(var kinematic_state)' />
    </include>
</launch>
